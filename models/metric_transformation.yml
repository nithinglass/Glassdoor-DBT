version: 2 
models: 
  - name: metric_transformation
    tests: 
      - dbt_utils.equality:
          compare_model: ref('slack_users_expected')
    columns:
        - name: ytd_sum
          tests : 
              - dbt_expectations.expect_column_values_to_be_within_n_moving_stdevs:
                  date_column_name: date
                  period: day
                  lookback_periods: 1
                  trend_periods: 7 
                  test_periods: 14 
                  sigma_threshold: 3 
                  take_logs: true 
                  sigma_threshold_upper: x 
                  sigma_threshold_lower: y 
                  take_diffs: true 
              - dbt_expectations.expect_column_values_to_be_within_n_stdevs:
                  group_by: period
                  sigma_threshold: 3
              - dbt_expectations.expect_column_values_to_be_within_n_moving_stdevs:
                  date_column_name: period